import{_ as S,d as j,s as z,a as G,A as H,Q as J,C as Q,D as K,T as O,H as b,o as W,c as n,e as a,f as d,h as p,u as c,q as X,x as m,j as e,t as i,E as k,F as C,z as F,i as l,G as Y,J as Z,n as N,R as V}from"./index.f7fb392c.js";import{_ as I}from"./loading.1e3c318a.js";import{_ as oo}from"./left_arrow_black.54b43e41.js";import{_ as P,c as B,a as D,b as T}from"./commentText.60ea446f.js";import{s as x,n as L}from"./num.de8f9d34.js";const so={class:"navSongList"},eo={class:"comment_count"},to={class:"song_info"},no={class:"img"},ao={key:0,class:"info"},ro={class:"title"},lo={key:0,class:"singer"},io={key:1,class:"singer"},uo=["onClick"],co={key:0},_o={class:"comment_choose"},po={class:"choose"},go={class:"comment_area"},fo={class:"avatar"},mo={class:"info"},vo={class:"top"},ho={class:"top_left"},yo={class:"name"},ko={key:0,style:{display:"flex","align-items":"center"}},Co={key:0,class:"level"},Fo={key:1,class:"level"},Bo={key:2,class:"level"},xo={key:3,class:"level"},Lo={key:4,class:"level"},Do={key:5,class:"level"},To={class:"time"},Ao={class:"time"},Ro={key:0,style:{margin:"0 2px"}},wo={key:1,class:"tag"},Eo={class:"like_count"},bo={class:"count"},No={key:0,src:D,alt:""},Vo={key:1,src:T,alt:""},Io=["onClick"],Po={class:"floor"},Uo={class:"reply_count"},qo={class:"comment_item floor_top"},$o={class:"avatar"},Mo={class:"info"},So={class:"top"},jo={class:"top_left"},zo={class:"name"},Go={class:"time"},Ho={class:"time"},Jo={class:"like_count"},Qo={class:"count"},Ko={key:0,src:D,alt:""},Oo={key:1,src:T,alt:""},Wo={class:"avatar"},Xo={class:"info"},Yo={class:"top"},Zo={class:"top_left"},os={class:"name"},ss={key:0,style:{display:"flex","align-items":"center"}},es={key:0,class:"level"},ts={key:1,class:"level"},ns={key:2,class:"level"},as={key:3,class:"level"},rs={key:4,class:"level"},ls={key:5,class:"level"},is={class:"time"},ds={class:"time"},us={class:"like_count"},cs={class:"count"},_s={key:0,src:D,alt:""},ps={key:1,src:T,alt:""},gs={key:0,class:"beReplied_item"},fs={class:"beReplied_name"},ms={key:0,class:"beReplied_content"},vs={key:1,class:"beReplied_content"},hs={name:"comment"},ys=j({...hs,setup(ks){const v=X(),h=z(),g=v.currentRoute.value.query.id;let u=v.currentRoute.value.query.type;const o=G({img:"",name:"",singer:"",singerInfo:[],commentTotal:0,pageNo:1,floorPageNo:0,sortType:2,sortTypeName:"",sortTypeList:[],cursor:"",arr:[],floorArr:[],floorTopComment:{user:{avatarUrl:""}},floorLoading:!1,floorError:!1,floorFinish:!1,showFloor:!1,imgloading:!0,arrloading:!0,requestLoading:!1,error:!1,finish:!1,haveFirstFloorPop:!1});H(async()=>{let r;if(u==2&&(r=await J(g),o.img=r.playlist.coverImgUrl,o.singer=r.playlist.creator.nickname,o.name=r.playlist.name),(u==0||u==null)&&(u=0,r=await Q(g),o.img=r.songs[0].al.picUrl,o.name=r.songs[0].name,o.singerInfo=o.singerInfo.concat(r.songs[0].ar),r.songs[0].ar.forEach((t,_)=>{_==0?o.singer+=`${t.name}`:o.singer+=`/${t.name}`})),u==3){const t=await K(g);o.name=t.album.name,o.img=t.album.picUrl,o.singerInfo=t.album.artists}u==4&&O("\u7535\u53F0\u8BC4\u8BBA\u6682\u65F6\u65E0\u6CD5\u83B7\u53D6"),r=await b(g,u,o.pageNo,20,o.sortType,o.cursor),o.commentTotal=r.data.totalCount,o.arr=r.data.comments,r.data.cursor&&(o.cursor=r.data.cursor),r.data.sortTypeList.forEach((t,_)=>{o.sortTypeList.push({text:t.sortTypeName,value:t.sortType})}),o.arrloading=!1,o.pageNo+=1,r.data.hasMore||(o.finish=!0)}),W(()=>{});const U=async(r,t)=>{if(o.floorTopComment=r,o.floorLoading=!0,h.set_floor_comment(!0),o.floorArr=[],o.floorFinish=!1,o.floorPageNo=0,o.haveFirstFloorPop){let _=await V(g,t,u,o.floorPageNo);o.floorArr=_.data.comments,o.floorPageNo+=1,o.floorArr.length&&(o.floorPageNo=o.floorArr[o.floorArr.length-1].time),_.data.hasMore||(o.floorFinish=!0),o.floorLoading=!1}},q=async()=>{o.floorLoading=!0,o.haveFirstFloorPop||(o.haveFirstFloorPop=!0);let r=await V(g,o.floorTopComment.commentId,u,o.floorPageNo);o.floorArr=o.floorArr.concat(r.data.comments),o.floorPageNo+=1,o.floorLoading=!1,o.floorArr.length&&(o.floorPageNo=o.floorArr[o.floorArr.length-1].time),r.data.hasMore||(o.floorFinish=!0)},A=async()=>{o.requestLoading=!0;let r=await b(g,u,o.pageNo,20,o.sortType,o.cursor);if(r.code!=200){o.error=!0,o.requestLoading=!1;return}o.requestLoading=!1,o.commentTotal=r.data.totalCount,o.cursor=r.data.cursor,o.arr=o.arr.concat(r.data.comments),o.arrloading=!1,o.pageNo+=1,r.data.hasMore||(o.finish=!0)},R=async r=>{o.sortType=r,o.finish=!1,o.cursor="",o.pageNo=1,o.arr=[],o.error=!1,A()},$=r=>{v.push({name:"singerDetail",query:{id:r}})};return(r,t)=>{const _=m("van-sticky"),y=m("van-image"),f=m("van-skeleton"),w=m("van-list"),M=m("van-popup");return n(),a("div",null,[d(w,{loading:o.requestLoading,"onUpdate:loading":t[3]||(t[3]=s=>o.requestLoading=s),error:o.error,"onUpdate:error":t[4]||(t[4]=s=>o.error=s),finished:o.finish,"immediate-check":!1,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:A},{loading:p(()=>t[9]||(t[9]=[e("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[e("img",{width:"18",src:I,alt:""}),e("span",null,"\u52A0\u8F7D\u4E2D...")],-1)])),default:p(()=>[d(_,null,{default:p(()=>[e("div",so,[e("div",{class:"back",onClick:t[0]||(t[0]=s=>c(v).go(-1))},t[10]||(t[10]=[e("img",{src:oo,alt:""},null,-1)])),e("div",eo,"\u8BC4\u8BBA("+i(o.commentTotal)+")",1)])]),_:1}),e("div",to,[e("div",no,[d(y,{radius:"8",class:"song_img",src:o.img},null,8,["src"])]),d(f,{title:"",row:3,loading:o.name==""},null,8,["loading"]),o.name?(n(),a("div",ao,[e("div",ro,i(o.name),1),c(u)==2?(n(),a("div",lo,[t[11]||(t[11]=e("span",{style:{color:"black"}},"by\xA0",-1)),k(i(o.singer),1)])):(n(),a("div",io,[t[12]||(t[12]=e("span",{style:{color:"black"}},"by\xA0",-1)),(n(!0),a(C,null,F(o.singerInfo,(s,E)=>(n(),a("span",{key:s.id,onClick:Cs=>$(s.id)},[k(i(s.name),1),E<o.singerInfo.length-1?(n(),a("span",co,"/")):l("",!0)],8,uo))),128))]))])):l("",!0)]),d(_,{"offset-top":50},{default:p(()=>[e("div",_o,[t[13]||(t[13]=e("div",{class:"title"},"\u8BC4\u8BBA\u533A",-1)),Y(e("div",po,[e("span",{class:N({choosed:o.sortType==2}),onClick:t[1]||(t[1]=s=>R(2))},"\u6700\u70ED",2),e("span",{class:N({choosed:o.sortType==3}),onClick:t[2]||(t[2]=s=>R(3))},"\u6700\u65B0",2)],512),[[Z,!o.arrloading]])])]),_:1}),d(f,{title:"",avatar:"",row:3,loading:o.arrloading},{default:p(()=>[e("div",go,[(n(!0),a(C,null,F(o.arr,s=>(n(),a("div",{class:"comment_item",key:s.commentId},[e("div",fo,[d(y,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),e("div",mo,[e("div",vo,[e("div",ho,[e("div",yo,[k(i(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(n(),a("span",ko,[t[14]||(t[14]=e("img",{src:P,alt:""},null,-1)),s.user.vipRights.redVipLevel==6?(n(),a("span",Co,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(n(),a("span",Fo,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(n(),a("span",Bo,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(n(),a("span",xo,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(n(),a("span",Lo,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(n(),a("span",Do,"\xB7\u4E00")):l("",!0)])):l("",!0)]),e("div",To,[e("span",Ao,i(c(x)(s.time)),1),s.tag.datas?(n(),a("span",Ro,"-")):l("",!0),s.tag.datas!=null&&s.tag.datas.length?(n(),a("span",wo,i(s.tag.datas[0].text),1)):l("",!0)])]),e("div",Eo,[e("span",bo,i(c(L)(s.likedCount)),1),s.liked?(n(),a("img",No)):(n(),a("img",Vo))])]),d(B,{content:s.content},null,8,["content"]),s.showFloorComment.showReplyCount?(n(),a("div",{key:0,class:"reply_count",onClick:E=>U(s,s.commentId)},i(s.showFloorComment.replyCount)+"\u6761\u56DE\u590D\xA0>",9,Io)):l("",!0)])]))),128))])]),_:1},8,["loading"]),d(f,{title:"",avatar:"",row:3,loading:o.arrloading},null,8,["loading"]),d(f,{title:"",avatar:"",row:3,loading:o.arrloading},null,8,["loading"]),d(f,{title:"",avatar:"",row:3,loading:o.arrloading},null,8,["loading"])]),_:1},8,["loading","error","finished"]),d(M,{show:c(h).showFloor,"onUpdate:show":t[7]||(t[7]=s=>c(h).showFloor=s),closeable:"",round:"",onClose:t[8]||(t[8]=s=>c(h).close()),"close-on-popstate":!0,"close-icon-position":"top-left",position:"bottom",style:{height:"80%"}},{default:p(()=>[d(w,{loading:o.floorLoading,"onUpdate:loading":t[5]||(t[5]=s=>o.floorLoading=s),error:o.floorError,"onUpdate:error":t[6]||(t[6]=s=>o.floorError=s),"immediate-check":!0,finished:o.floorFinish,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:q},{loading:p(()=>t[15]||(t[15]=[e("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[e("img",{width:"18",src:I,alt:""}),e("span",null,"\u52A0\u8F7D\u4E2D...")],-1)])),default:p(()=>[e("div",Po,[e("div",Uo,"\u56DE\u590D("+i(o.floorArr.length)+")",1),e("div",qo,[e("div",$o,[d(y,{round:"",width:"30",height:"30",src:o.floorTopComment.user.avatarUrl},null,8,["src"])]),e("div",Mo,[e("div",So,[e("div",jo,[e("div",zo,i(o.floorTopComment.user.nickname),1),e("div",Go,[e("span",Ho,i(c(x)(o.floorTopComment.time)),1)])]),e("div",Jo,[e("span",Qo,i(c(L)(o.floorTopComment.likedCount)),1),o.floorTopComment.liked?(n(),a("img",Ko)):(n(),a("img",Oo))])]),d(B,{content:o.floorTopComment.content},null,8,["content"])])]),t[17]||(t[17]=e("div",{class:"all_reply"},"\u5168\u90E8\u56DE\u590D",-1)),(n(!0),a(C,null,F(o.floorArr,s=>(n(),a("div",{class:"comment_item",key:s.commentId},[e("div",Wo,[d(y,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),e("div",Xo,[e("div",Yo,[e("div",Zo,[e("div",os,[k(i(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(n(),a("span",ss,[t[16]||(t[16]=e("img",{src:P,alt:""},null,-1)),s.user.vipRights.redVipLevel==6?(n(),a("span",es,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(n(),a("span",ts,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(n(),a("span",ns,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(n(),a("span",as,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(n(),a("span",rs,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(n(),a("span",ls,"\xB7\u58F9")):l("",!0)])):l("",!0)]),e("div",is,[e("span",ds,i(c(x)(s.time)),1)])]),e("div",us,[e("span",cs,i(c(L)(s.likedCount)),1),s.liked?(n(),a("img",_s)):(n(),a("img",ps))])]),d(B,{content:s.content},null,8,["content"]),s.beReplied.length&&s.beReplied[0].beRepliedCommentId!=o.floorTopComment.commentId?(n(),a("div",gs,[e("span",fs,"@"+i(s.beReplied[0].user.nickname)+"\uFF1A",1),s.beReplied[0].content?(n(),a("span",ms,i(s.beReplied[0].content),1)):(n(),a("span",vs,"\u8BE5\u8BC4\u8BBA\u5DF2\u5220\u9664"))])):l("",!0)])]))),128))])]),_:1},8,["loading","error","finished"])]),_:1},8,["show"])])}}});var Ts=S(ys,[["__scopeId","data-v-130eb76f"]]);export{Ts as default};
