import{_ as K,d as Q,r as a,s as U,T as P,a as R,A as Z,o as ee,w as k,c as u,e as f,j as t,u as l,t as g,n as d,G as se,i as M,k as te,F as oe,z as le,l as X,q as ie,H as ne,I as B,J as ae}from"./index.f7fb392c.js";import{_ as re}from"./share.56451215.js";import{B as ue,_ as fe}from"./core.esm.ccae187d.js";import{_ as ve}from"./songInfo.ee9e09a9.js";import{_ as _e}from"./play_white.b19edd9c.js";import{g as S}from"./num.de8f9d34.js";import{d as de}from"./download.ff8c4cb5.js";var ce="/assets/arrow_down.7cf71c80.svg",H="/assets/volume.c8ee860b.svg",me="/assets/needle.60c17542.png",ge="/assets/like_white.446989e4.svg",pe="/assets/sing.5fe37645.svg",ye="/assets/comment_num.7683d72f.svg",he="/assets/circulate.dae8c7da.svg",ke="/assets/circulate_random.f0fea622.svg",be="/assets/circulate_one.50becdd2.svg",O="/assets/last_song.50462e9f.svg",Ce="/assets/stop_white.e331bfd5.svg",we="/assets/list_white.9fd8f699.svg";const $e={class:"popup"},Te={class:"song_pop"},Le={class:"bg_blur"},Fe=["src"],Pe={class:"nav"},Me={class:"title"},Be={class:"name"},Se={class:"author"},Ae={class:"img"},De={class:"middle"},Ee=["src"],We={key:0},xe=["id","innerHTML"],Re={class:"icon_top"},Xe={class:"comment_num"},He={class:"progress"},Oe={class:"current_time"},qe={class:"durasion"},ze={class:"bottom_icon"},Ie={name:"song"},Ne=Q({...Ie,setup(Ve){const p=ie();a(0);const s=U();s.song_info.id===""&&(P("\u4F60\u53EF\u771F\u662F\u4E2A\u5C0F\u57FA\u4F6C"),p.push({name:"404"}));const v=a(!1),m=a(!1),C=a(!0);R([]);const w=a(!0);let A=a();const $=a(0);let c=a(0);const _=a(""),T=a(),b=a(),y=a();let r=R({bs:""});const q=()=>{p.go(-1)},z=()=>{de(s.song_info.url,{id:s.song_info.id,name:s.song_info.name,author:s.song_info.author})},D=async()=>{try{let e=(await ne(s.song_info.id,0,1,20,3,"")).data.totalCount;e>=100&&e<1e3?_.value="99+":e>=1e3&&e<1e4?_.value="999+":e===1e4?_.value="1w":e>1e4&&e<1e5?_.value="1w+":e>=1e5?_.value="10w+":_.value=_.value.toString()}catch{P("\u83B7\u53D6\u6B4C\u8BCD\u51FA\u9519")}},I=()=>{p.push({path:"/comment",query:{id:s.song_info.id,type:s.song_info.type}})};Z(()=>{s.song_info.id||p.push("/")}),ee(async()=>{T.value.style.width=`${s.song_info.buffered/s.song_info.duration*100}%`,r.bs=new ue(".lyric",{probeType:2,momentum:!1,scrollX:!1,scrollY:!0,click:!0,disableTouch:!1}),r.bs.on("beforeScrollStart",()=>{}),r.bs.on("scroll",n=>{m.value=!0;let e=Math.abs(n.y)/A.value.children[0].offsetHeight;c.value=s.song_info.lyricAll[Math.ceil(e)-1<=0?0:Math.ceil(e)-1].time}),r.bs.on("scrollEnd",()=>{m.value&&s.set_progress_time(c.value),m.value=!1}),r.bs.disable(),s.song_info.id&&!_.value&&D()}),k(()=>s.song_info.lyricAll.length,()=>{B(()=>{r.bs.refresh()})}),k(()=>s.song_info.id,n=>{n!=""&&D()}),k(()=>p.currentRoute.value.name,n=>{n!="song"?w.value=!1:w.value=!0}),k(()=>s.song_info.currentTime,()=>{w.value&&!m.value&&(c.value=s.song_info.currentTime,s.song_info.lyricAll.forEach((n,e,o)=>{c.value>=n.time&&c.value<=o[e+1].time&&r.bs.scrollToElement(`#s${e}`,100)})),C.value&&(b.value.style.left=`${s.song_info.currentTime/s.song_info.duration*100}%`)}),k(()=>s.song_info.buffered,()=>{T.value.style.width=`${s.song_info.buffered/s.song_info.duration*100}%`});function E(){s.play(!s.song_info.isPlaying),B(()=>{r.bs.refresh()})}const W=()=>{v.value=!v.value,B(()=>{r.bs.refresh()}),v.value?r.bs.enable():(r.bs.disable(),m.value=!1)};a(!1);const N=n=>{C.value=!1;let e=y.value.offsetWidth,i=(n.touches[0].clientX-y.value.offsetLeft)/e;$.value=s.song_info.duration*i,i>=0&&i<=1&&(b.value.style.left=`${i*100}%`)},V=n=>{let e=y.value.offsetWidth,i=(n.touches[0].clientX-y.value.offsetLeft)/e;$.value=s.song_info.duration*i,i>=0&&i<=1&&(b.value.style.left=`${i*100}%`)},j=n=>{C.value=!0,s.set_progress_time($.value)},h=a(),L=a(),F=a(),G=n=>{let e=h.value.offsetWidth,i=(n.touches[0].clientX-h.value.offsetLeft)/e;i>=0&&i<=1&&(s.set_volume(parseFloat(i.toFixed(1))),F.value.style.left=`${i*100}%`,L.value.style.width=`${i*100}%`)},J=n=>{let e=h.value.offsetWidth,i=(n.touches[0].clientX-h.value.offsetLeft)/e;i>=0&&i<=1&&(s.set_volume(parseFloat(i.toFixed(1))),F.value.style.left=`${i*100}%`,L.value.style.width=`${i*100}%`)},Y=()=>{let n={id:s.song_info.id,name:s.song_info.name,author:s.song_info.author,img:s.song_info.img,type:s.song_info.type,isSongClik:!0,al:s.song_info.al};s.set_pop_detail(n)},x=()=>{P("\u656C\u8BF7\u671F\u5F85")};return(n,e)=>(u(),f("div",$e,[t("div",Te,[t("div",Le,[t("img",{src:l(s).song_info.img,alt:""},null,8,Fe)]),t("div",Pe,[t("div",{class:"back"},[t("img",{src:ce,onClick:q,alt:""})]),t("div",Me,[t("div",Be,g(l(s).song_info.name),1),t("div",Se,g(l(s).song_info.author),1)]),e[19]||(e[19]=t("div",{class:"share",style:{opacity:"0"}},[t("img",{src:re,alt:""})],-1))]),t("div",{class:d(["volume",{hidden:!v.value}])},[e[22]||(e[22]=t("div",{class:"img"},[t("img",{src:H,alt:""})],-1)),t("div",{class:"line",ref_key:"volume_line",ref:h,onTouchstart:e[0]||(e[0]=o=>G(o)),onTouchmove:e[1]||(e[1]=o=>J(o))},[t("div",{class:"past",ref_key:"volume_linePast",ref:L},null,512),t("div",{class:"circle_point",ref_key:"volume_point",ref:F},null,512),e[20]||(e[20]=t("div",{class:"not_play"},null,-1))],544),se(t("div",Ae,e[21]||(e[21]=[t("img",{src:H,alt:""},null,-1)]),512),[[ae,!1]])],2),v.value?M("",!0):(u(),f("img",{key:0,class:d(["needle",{needle_play:l(s).song_info.isPlaying,hidden:v.value}]),src:me,alt:""},null,2)),t("div",{class:d(["rotate",{hidden:v.value}]),style:te({animationPlayState:l(s).song_info.isPlaying?"running":"paused"}),onClick:e[2]||(e[2]=o=>W())},[t("div",De,[t("img",{src:l(s).song_info.img,alt:""},null,8,Ee)])],6),t("div",{class:d(["lyric_wrapper",{show_all_lyric:v.value}]),onClick:e[3]||(e[3]=o=>W())},[t("div",{class:d(["lyric_line",{lyric_lineTime_show:m.value}])},null,2),t("div",{class:d(["lyric_line_time",{lyric_lineTime_show:m.value}])},g(l(S)(l(c))),3),t("div",{class:d(["lyric",{lyric_show:v.value}])},[l(s).song_info.lyricAll.length==0?(u(),f("span",We,"\u83B7\u53D6\u6B4C\u8BCD\u4E2D")):M("",!0),t("div",{ref_key:"lyricRef",ref:A},[(u(!0),f(oe,null,le(l(s).song_info.lyricAll,(o,i)=>(u(),f("div",{key:i,id:"s"+i,class:d({lyric_base:!0,lyric_white:o.time<=l(c)&&l(c)<l(s).song_info.lyricAll[i+1].time}),innerHTML:o.lyric},null,10,xe))),128)),e[23]||(e[23]=t("div",{class:"lyric_bottom"},null,-1))],512)],2)],2),t("div",Re,[t("img",{src:ge,onClick:e[4]||(e[4]=o=>x()),alt:""}),t("img",{src:fe,onClick:e[5]||(e[5]=o=>z()),alt:""}),t("img",{src:pe,onClick:e[6]||(e[6]=o=>x()),alt:""}),t("div",{class:"comment",onClick:e[7]||(e[7]=o=>I())},[e[24]||(e[24]=t("img",{src:ye,alt:""},null,-1)),t("div",Xe,g(_.value),1)]),t("img",{src:ve,onClick:Y,alt:""})]),t("div",He,[t("div",Oe,g(l(S)(l(s).song_info.currentTime)),1),t("div",{class:"line",ref_key:"line",ref:y,onTouchstart:e[8]||(e[8]=o=>N(o)),onTouchmove:e[9]||(e[9]=o=>V(o)),onTouchend:e[10]||(e[10]=o=>j())},[t("div",{class:"past",ref_key:"linePast",ref:T},null,512),t("div",{class:d({circle_point:!0}),ref_key:"point",ref:b},null,512),e[25]||(e[25]=t("div",{class:"not_play"},null,-1))],544),t("div",qe,g(l(S)(l(s).song_info.duration)),1)]),t("div",ze,[l(s).song_info.playMode==1?(u(),f("img",{key:0,onClick:e[11]||(e[11]=o=>l(s).set_circulate()),src:he,alt:""})):l(s).song_info.playMode==2?(u(),f("img",{key:1,onClick:e[12]||(e[12]=o=>l(s).set_circulate()),src:ke,alt:""})):l(s).song_info.playMode==3?(u(),f("img",{key:2,onClick:e[13]||(e[13]=o=>l(s).set_circulate()),src:be,alt:""})):M("",!0),t("img",{onClick:e[14]||(e[14]=o=>l(s).play_next(-1)),src:O,alt:""}),l(s).song_info.isPlaying?(u(),f("img",{key:3,class:"bigPlay",onClick:e[15]||(e[15]=X(o=>E(),["stop"])),src:Ce,alt:""})):(u(),f("img",{key:4,class:"bigPlay",onClick:e[16]||(e[16]=X(o=>E(),["stop"])),src:_e,alt:""})),t("img",{onClick:e[17]||(e[17]=o=>l(s).play_next(null)),src:O,style:{transform:"rotate(180deg)"},alt:""}),t("img",{onClick:e[18]||(e[18]=o=>l(s).set_pop_list(!0)),src:we,alt:""})])])]))}});var Ze=K(Ne,[["__scopeId","data-v-48ef1378"]]);export{Ze as default};
