import{_ as R,d as z,r as u,s as M,a as B,w as _,o as q,g as D,T as m,b as U,c as a,e as r,f as F,h as C,u as t,i as g,n as E,j as e,k as N,t as d,l as w,m as b,p as V,q as H,v as K,x as A,y as j,K as O,F as G,z as J}from"./index.f7fb392c.js";import{_ as $}from"./loading.1e3c318a.js";import{_ as Q}from"./sub.f0b346da.js";import{_ as W}from"./comment.17c56d6e.js";import{_ as X}from"./share.56451215.js";import{d as Y}from"./download.ff8c4cb5.js";var Z="/assets/stop_icon.f272f983.svg",ss="/assets/play_icon.971b473f.svg",os="/assets/list_icon.82c00d89.svg",es="/assets/circulate_gray.91b2c30b.svg",ts="/assets/circulate_random_gray.6d9ef32b.svg",ns="/assets/circulate_one_gray.cd22f14b.svg",is="/assets/collect_gray.f1b40daf.svg",ls="/assets/finger.bd88e2ba.svg",as="/assets/delete_gray.de068543.svg",us="/assets/delete.f02346d1.svg",rs="/assets/cover-bg-in.c5a56a3e.png",ds="/assets/download_gray.ec9df863.svg",_s="/assets/singer.b8c9cb78.svg",gs="/assets/album.86b904fe.svg",ps="/assets/cloud.ca8a16e8.svg",vs="/assets/lingsheng.6ca203ba.svg",ms="/assets/buy.4891d408.svg",fs="/assets/hide.ed379cee.svg";const cs={class:"home"},ys={key:0,class:"songDiv"},Fs=["src"],Cs={class:"info"},Es={class:"song_name"},bs={class:"song_author"},ks={key:0,src:Z,alt:""},Bs={key:1,src:ss,alt:""},Ds={class:"pop_list"},ws={class:"title"},As={class:"option"},$s={key:0,class:"circulate"},xs={key:1,class:"circulate"},Ls={key:2,class:"circulate"},Ts={class:"get"},hs={class:"list"},Ss=["onClick"],Is={class:"icon"},Ps={key:0,src:$,alt:""},Rs={class:"author"},zs=["onClick"],Ms={key:0,class:"load"},qs={class:"song_detail"},Us={class:"info"},Ns={class:"img"},Vs=["src"],Hs={class:"title"},Ks={class:"author"},js={class:"item"},Os={class:"item"},Gs={name:"home"},Js=z({...Gs,setup(Qs){const p=H();K(),u(0);const s=M(),n=u(new Audio);u(),u(),u(),u(),u();let y=u();u("00:00.00"),B([]),u();const k=u(""),f=B(["song","discover"]);function x(){s.play(!s.song_info.isPlaying)}const L=()=>{p.push({path:"/song"})};function T(){y.value=setInterval(()=>{s.set_song_time(n.value.currentTime),s.set_song_allTime(n.value.duration)},1e3)}_(()=>s.song_info.isPlaying,(l,o)=>{l?(n.value.src||(n.value.src=s.song_info.url),n.value.autoplay=!0,n.value.play(),T()):(n.value.pause(),clearInterval(y.value))}),_(()=>s.song_info.id,async(l,o)=>{if(l){n.value.pause(),m.loading({message:"\u83B7\u53D6\u97F3\u4E50\u4E2D\uFF0C\u8BF7\u7A0D\u540E",overlay:!0,duration:0,forbidClick:!0});const v=await D(s.song_info.id,s.song_info.type);m.clear(),s.set_song_url(v.data[0].url),n.value.src=s.song_info.url,n.value.play(),s.play(!0),s.song_info.id&&s.lyricRequest()}}),_(()=>s.song_info.progressTime,()=>{n.value.currentTime=s.song_info.progressTime}),_(()=>p.currentRoute.value,(l,o)=>{if(s.set_load(!1),l.meta.level>o.meta.level){if(o.name=="song")return;f.push(l.name),k.value="slide-left"}else f.splice(f.indexOf(o.name),1),k.value="slide-right"}),_(()=>s.song_info.currentTime,l=>{s.song_info.lyricAll.forEach((o,v,c)=>{l>=o.time&&l<=c[v+1].time&&s.set_lyric(o.lyric)})}),_(()=>s.song_info.volume,l=>{n.value.volume=s.song_info.volume}),_(()=>s.song_info.lyric,l=>{console.info(`%c > ${l.replace("<br>"," > ")}`,"color:#db2c1f;background:rgba(0,0,0,0.2);font-size:25px;border-radius:6px")}),q(async()=>{if(s.song_info.id){const l=await D(s.song_info.id);s.set_song_url(l.data[0].url),s.song_info.list.length==0&&s.add_song({id:s.song_info.id,name:s.song_info.name,author:s.song_info.author,img:s.song_info.img,url:s.song_info.url})}localStorage.getItem("songId")&&m("\u53D1\u73B0\u4E0A\u6B21\u64AD\u653E\u6570\u636E\uFF0C\u52A0\u5165\u64AD\u653E\u5217\u8868"),n.value.preload="auto",n.value.load(),n.value.addEventListener("progress",()=>{if(s.set_song_allTime(n.value.duration),n.value.buffered.length>0){let l=n.value.buffered.end(n.value.buffered.length-1);s.set_song_buffered(l)}}),n.value.addEventListener("loadstart",()=>{}),n.value.addEventListener("error",()=>{s.play(!1),m.fail("\u6570\u636E\u7F13\u51B2\u5931\u8D25")}),n.value.addEventListener("stalled",()=>{s.song_info.isPlaying&&m("\u5F53\u524D\u7F51\u7EDC\u8F83\u5DEE"),s.song_info.duration||s.set_song_allTime(0)}),n.value.addEventListener("waiting",()=>{}),n.value.addEventListener("play",()=>{console.info("%c > console \u6B4C\u8BCD\u7CFB\u7EDF\u5DE5\u4F5C ing","color:#db2c1f;background:rgba(0,0,0,0.2);font-size:25px;border-radius:6px")}),n.value.addEventListener("pause",()=>{}),n.value.addEventListener("ended",()=>{s.play(!1),s.play_next(null)}),n.value.addEventListener("ready",()=>{}),s.song_info.id&&s.lyricRequest(),window.addEventListener("popstate",()=>{setTimeout(()=>{let l=sessionStorage.getItem("scrollTop");l&&window.scrollTo(0,parseInt(l))},520)})});const h=u("slide");h.value="slide-left",U(()=>{clearInterval(y.value)});const S=()=>{s.set_pop_list(!0)},I=l=>{s.close(),p.push({path:"/comment",query:{id:l}})};return(l,o)=>{const v=A("router-view"),c=A("van-popup");return a(),r("div",cs,[F(v,null,{default:C(({Component:i})=>[(a(),b(O,{include:f},[(a(),b(j(i)))],1032,["include"]))]),_:1}),t(s).song_info.id&&t(p).currentRoute.value.name!="song"?(a(),r("div",ys)):g("",!0),t(p).currentRoute.value.name!="song"?(a(),r("div",{key:1,class:E(["song",{fixed_out:!t(s).song_info.id}]),onClick:o[1]||(o[1]=i=>L())},[e("div",{class:"song_img rotate",style:N({animationPlayState:t(s).song_info.isPlaying?"running":"paused"})},[e("img",{src:t(s).song_info.img,alt:""},null,8,Fs)],4),e("div",Cs,[e("div",Es,d(t(s).song_info.name),1),e("div",bs,"-"+d(t(s).song_info.author),1)]),e("div",{class:"icon",onClick:o[0]||(o[0]=w(i=>x(),["stop"]))},[t(s).song_info.isPlaying?(a(),r("img",ks)):(a(),r("img",Bs))]),e("img",{onClick:w(S,["stop"]),src:os,alt:""})],2)):g("",!0),F(c,{show:t(s).showList,"onUpdate:show":o[6]||(o[6]=i=>t(s).showList=i),"lock-scroll":!1,round:"",onClose:o[7]||(o[7]=i=>t(s).close()),"close-on-popstate":!0,position:"bottom",style:{height:"50%"}},{default:C(()=>[e("div",Ds,[e("div",ws,"\u5F53\u524D\u64AD\u653E\u5217\u8868("+d(t(s).song_info.list.length)+")",1),e("div",As,[t(s).song_info.playMode==1?(a(),r("div",$s,[e("img",{onClick:o[2]||(o[2]=i=>t(s).set_circulate()),src:es,alt:""}),o[13]||(o[13]=e("span",null,"\u5217\u8868\u5FAA\u73AF",-1))])):g("",!0),t(s).song_info.playMode==2?(a(),r("div",xs,[e("img",{onClick:o[3]||(o[3]=i=>t(s).set_circulate()),src:ts,alt:""}),o[14]||(o[14]=e("span",null,"\u968F\u673A\u64AD\u653E",-1))])):g("",!0),t(s).song_info.playMode==3?(a(),r("div",Ls,[e("img",{onClick:o[4]||(o[4]=i=>t(s).set_circulate()),src:ns,alt:""}),o[15]||(o[15]=e("span",null,"\u5355\u66F2\u5FAA\u73AF",-1))])):g("",!0),e("div",Ts,[o[16]||(o[16]=e("img",{src:is,alt:""},null,-1)),o[17]||(o[17]=e("img",{class:"finger",src:ls,alt:""},null,-1)),o[18]||(o[18]=e("span",null,"\u6536\u85CF\u5168\u90E8",-1)),e("img",{class:"del_list",onClick:o[5]||(o[5]=i=>t(s).delete_all()),src:as,alt:""})])]),e("div",hs,[(a(!0),r(G,null,J(t(s).song_info.list,i=>(a(),r("div",{class:"item",key:i.id},[e("div",{class:E({info:!0,red:i.id==t(s).song_info.id}),onClick:P=>t(s).play_by_id(i.id)},[e("div",Is,[i.id==t(s).song_info.id?(a(),r("img",Ps)):g("",!0)]),e("span",{class:E({name:!0,red:i.id==t(s).song_info.id})},d(i.name),3),o[19]||(o[19]=e("span",null,"\xA0-\xA0",-1)),e("span",Rs,d(i.author),1)],10,Ss),e("img",{class:"delete",onClick:P=>t(s).delete(i.id),src:us,alt:""},null,8,zs)]))),128))])])]),_:1},8,["show"]),(a(),b(V,{to:"#app"},[t(s).showLoading?(a(),r("div",Ms,o[20]||(o[20]=[e("img",{src:$,alt:""},null,-1),e("span",null,"\u52A0\u8F7D\u4E2D...",-1)]))):g("",!0)])),F(c,{show:t(s).showDetail,"onUpdate:show":o[11]||(o[11]=i=>t(s).showDetail=i),round:"",onClose:o[12]||(o[12]=i=>t(s).close()),"close-on-popstate":!0,position:"bottom",style:{height:"50%"}},{default:C(()=>[e("div",qs,[e("div",Us,[e("div",Ns,[e("img",{src:t(s).song_pop_detail.img,alt:""},null,8,Vs)]),e("div",Hs,[e("span",null,"\u6B4C\u66F2\uFF1A"+d(t(s).song_pop_detail.name),1),e("span",Ks,d(t(s).song_pop_detail.author),1)])]),e("div",{class:"item",onClick:o[8]||(o[8]=i=>t(s).add_song(t(s).song_pop_detail))},o[21]||(o[21]=[e("img",{style:{"border-radius":"50%"},src:rs,alt:""},null,-1),e("span",null,"\u4E0B\u4E00\u9996\u64AD\u653E",-1)])),o[26]||(o[26]=e("div",{class:"item"},[e("img",{src:Q,alt:""}),e("span",null,"\u6536\u85CF\u5230\u6B4C\u5355")],-1)),e("div",{class:"item",onClick:o[9]||(o[9]=i=>t(Y)(t(s).song_pop_detail.url,{id:t(s).song_pop_detail.id,name:t(s).song_pop_detail.name,author:t(s).song_pop_detail.author}))},o[22]||(o[22]=[e("img",{src:ds,alt:""},null,-1),e("span",null,"\u4E0B\u8F7D",-1)])),e("div",{class:"item",onClick:o[10]||(o[10]=i=>I(t(s).song_pop_detail.id.toString()))},[o[23]||(o[23]=e("img",{src:W,alt:""},null,-1)),e("span",null,"\u8BC4\u8BBA\uFF08"+d(t(s).song_pop_detail.commentCount)+"\uFF09",1)]),o[27]||(o[27]=e("div",{class:"item"},[e("img",{src:X,alt:""}),e("span",null,"\u5206\u4EAB")],-1)),e("div",js,[o[24]||(o[24]=e("img",{src:_s,alt:""},null,-1)),e("span",null,"\u6B4C\u624B\uFF1A"+d(t(s).song_pop_detail.author),1)]),e("div",Os,[o[25]||(o[25]=e("img",{src:gs,alt:""},null,-1)),e("span",null,"\u4E13\u8F91\uFF1A"+d(t(s).song_pop_detail.al),1)]),o[28]||(o[28]=e("div",{class:"item"},[e("img",{src:ps,alt:""}),e("span",null,"\u4E91\u8D1D\u63A8\u6B4C")],-1)),o[29]||(o[29]=e("div",{class:"item"},[e("img",{src:vs,alt:""}),e("span",null,"\u8BBE\u7F6E\u94C3\u58F0")],-1)),o[30]||(o[30]=e("div",{class:"item"},[e("img",{src:ms,alt:""}),e("span",null,"\u5355\u66F2\u8D2D\u4E70")],-1)),o[31]||(o[31]=e("div",{class:"item"},[e("img",{src:fs,alt:""}),e("span",null,"\u5C4F\u853D\u6B4C\u66F2\u6216\u8005\u6B4C\u624B")],-1))])]),_:1},8,["show"])])}}});var eo=R(Js,[["__scopeId","data-v-21e0941a"]]);export{eo as default};
