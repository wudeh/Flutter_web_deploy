import{P as f,_ as z,d as H,s as J,a as K,A as O,H as N,w as Q,c as i,e as r,j as o,u,f as d,h as _,q as W,x as m,t as n,i as l,F as k,z as F,G as X,J as Y,n as D,E as U,T as Z,R as V}from"./index.f7fb392c.js";import{_ as tt}from"./left_arrow.037609f2.js";import{b,_ as I,c as B,a as A}from"./commentText.60ea446f.js";import{_ as ot}from"./sub.f0b346da.js";import{_ as et}from"./share.56451215.js";import{_ as st}from"./play_white.b19edd9c.js";import{_ as $}from"./loading.1e3c318a.js";import{n as h,s as T,t as at}from"./num.de8f9d34.js";function it(c){return f.post(`/user/detail?uid=${c}`)}function rt(c){return f.get(`/video/url?id=${c}`)}function nt(c){return f.get(`/video/detail?id=${c}`)}function lt(c){return f.get(`/related/allvideo?id=${c}`)}function dt(c){return f.get(`/mv/url?id=${c}`)}function ut(c){return f.get(`/mv/detail?mvid=${c}`)}function ct(c){return f.get(`/artist/detail?id=${c}`)}const pt={class:"nav"},_t={class:"back"},vt=["src"],mt={class:"info"},ft={class:"author"},ht={class:"img"},gt={class:"detail"},yt={class:"name"},Ct={key:0,class:"fan"},kt={class:"vid_detail"},Ft={class:"title"},Tt={class:"vid_count"},bt={class:"playTime"},wt={key:0,class:"publishTime"},xt={key:1,class:"publishTime"},Dt={class:"des"},Bt={class:"count"},At={key:0,class:"count_item"},Rt={class:"count_item"},Et={class:"count_item"},Lt={class:"tag"},Nt={class:"related"},Ut=["onClick"],Vt={class:"left"},It={class:"info"},$t={class:"name"},Pt={class:"comment_choose"},qt={class:"choose"},Gt={class:"comment_area"},Mt={class:"avatar"},jt={class:"info"},St={class:"top"},zt={class:"top_left"},Ht={class:"name"},Jt={key:0,style:{display:"flex","align-items":"center"}},Kt={key:0,class:"level"},Ot={key:1,class:"level"},Qt={key:2,class:"level"},Wt={key:3,class:"level"},Xt={key:4,class:"level"},Yt={key:5,class:"level"},Zt={class:"time"},to={class:"time"},oo={key:0,style:{margin:"0 2px"}},eo={key:1,class:"tag"},so={class:"like_count"},ao={class:"count"},io={key:0,src:A,alt:""},ro={key:1,src:b,alt:""},no=["onClick"],lo={class:"floor"},uo={class:"reply_count"},co={class:"comment_item floor_top"},po={class:"avatar"},_o={class:"info"},vo={class:"top"},mo={class:"top_left"},fo={class:"name"},ho={class:"time"},go={class:"time"},yo={class:"like_count"},Co={class:"count"},ko={key:0,src:A,alt:""},Fo={key:1,src:b,alt:""},To={class:"avatar"},bo={class:"info"},wo={class:"top"},xo={class:"top_left"},Do={class:"name"},Bo={key:0,style:{display:"flex","align-items":"center"}},Ao={key:0,class:"level"},Ro={key:1,class:"level"},Eo={key:2,class:"level"},Lo={key:3,class:"level"},No={key:4,class:"level"},Uo={key:5,class:"level"},Vo={class:"time"},Io={class:"time"},$o={class:"like_count"},Po={class:"count"},qo={key:0,src:A,alt:""},Go={key:1,src:b,alt:""},Mo={key:0,class:"beReplied_item"},jo={class:"beReplied_name"},So={key:0,class:"beReplied_content"},zo={key:1,class:"beReplied_content"},Ho={name:"vid"},Jo=H({...Ho,setup(c){const g=J(),w=W(),v=w.currentRoute.value.query.vid,t=K({vid:"",type:5,activeName:"1",url:"",followed:!1,userId:0,fans:0,nickname:"",avatarUrl:"",identityIconUrl:"",title:"",description:"",durationms:0,playTime:0,praisedCount:0,commentCount:0,shareCount:0,subscribeCount:0,publishTime:0,videoGroup:[],videoRelated:[],commentTotal:0,pageNo:1,floorPageNo:1,sortType:99,sortTypeName:"",sortTypeList:[],cursor:"",arr:[],floorArr:[],floorTopComment:{user:{avatarUrl:""}},floorLoading:!1,floorError:!1,floorFinish:!1,showFloor:!1,imgloading:!0,arrloading:!0,requestLoading:!1,error:!1,finish:!1,haveFirstFloorPop:!1});O(async()=>{Number.isNaN(Number(v))?t.type=5:t.type=1,t.vid=v,t.arrloading=!0;let e=await N(v,t.type,t.pageNo,20,t.sortType,t.cursor);if(t.arrloading=!1,e.code==400){t.error=!0;return}t.commentCount=e.data.totalCount,t.arr=e.data.comments,e.data.cursor&&(t.cursor=e.data.cursor),e.data.sortTypeList.forEach((a,p)=>{t.sortTypeList.push({text:a.sortTypeName,value:a.sortType})}),t.pageNo+=1,e.data.hasMore||(t.finish=!0)}),Q(()=>t.vid,(e,a)=>{t.url="",w.replace({name:"vid",query:{vid:e}}),P()});const P=async()=>{t.videoGroup.splice(0);let e;t.type==5&&(e=await nt(t.vid),t.vid=e.data.vid,t.followed=e.data.creator.followed,t.nickname=e.data.creator.nickname,t.userId=e.data.creator.userId,t.avatarUrl=e.data.creator.avatarUrl,t.identityIconUrl=e.data.creator.avatarDetail?e.data.creator.avatarDetail.identityIconUrl:"",t.title=e.data.title,t.description=e.data.description,t.durationms=e.data.durationms,t.playTime=e.data.playTime,t.praisedCount=e.data.praisedCount,t.shareCount=e.data.shareCount,t.subscribeCount=e.data.subscribeCount,t.publishTime=e.data.publishTime,t.videoGroup=e.data.videoGroup),t.type==1&&(e=await ut(t.vid),t.url=e.data.url,t.vid=e.data.id,t.followed=e.data.artists[0].followed,t.nickname=e.data.artistName,t.userId=e.data.artistId,t.title=e.data.briefDesc,t.description=e.data.desc,t.durationms=e.data.duration,t.playTime=e.data.playCount,t.praisedCount=e.data.praisedCount||0,t.commentCount=e.data.commentCount,t.shareCount=e.data.shareCount,t.subscribeCount=e.data.subCount,t.publishTime=e.data.publishTime,t.videoGroup=e.data.videoGroup),t.type==5&&(e=await rt(t.vid),t.url=e.urls[0].url,e.urls[0].needPay&&Z("\u5F53\u524D\u89C6\u9891\u9700\u4ED8\u8D39\u89C2\u770B"),e=await it(t.userId),t.fans=e.profile.followeds),t.type==1&&(e=await dt(t.vid),t.url=e.data.url,e=await ct(t.userId),t.avatarUrl=e.data.artist.cover),e=await lt(t.vid),t.videoRelated=e.data},q=async(e,a)=>{if(console.log("\u5F39\u51FA\u697C\u5C42"),t.floorTopComment=e,t.floorLoading=!0,g.set_floor_comment(!0),t.floorArr=[],t.floorFinish=!1,t.floorPageNo=0,t.haveFirstFloorPop){let p=await V(v,a,t.type,t.floorPageNo);if(t.floorLoading=!1,p.code==400){t.floorError=!0;return}t.floorArr=p.data.comments,t.floorArr.length&&(t.floorPageNo=t.floorArr[t.floorArr.length-1].time),p.data.hasMore||(t.floorFinish=!0)}},G=async()=>{t.floorError=!1,t.floorLoading=!0,t.haveFirstFloorPop||(t.haveFirstFloorPop=!0);let e=await V(v,t.floorTopComment.commentId,t.type,t.floorPageNo);if(t.floorLoading=!1,e.code==400){t.floorError=!0;return}t.floorArr=t.floorArr.concat(e.data.comments),t.floorLoading=!1,t.floorArr.length&&(t.floorPageNo=t.floorArr[t.floorArr.length-1].time),e.data.hasMore||(t.floorFinish=!0)},R=async()=>{t.error=!1,t.requestLoading=!0;let e=await N(v,t.type,t.pageNo,20,t.sortType,t.cursor);if(t.arrloading=!1,t.requestLoading=!1,e.code==400){t.error=!0;return}t.commentCount=e.data.totalCount,t.cursor=e.data.cursor,t.arr=t.arr.concat(e.data.comments),t.arrloading=!1,t.pageNo+=1,(!e.data.hasMore||t.arr.length>=e.data.totalCount)&&(t.finish=!0)},x=async e=>{t.sortType=e,t.finish=!1,t.pageNo=1,t.arr=[],t.cursor="",R()};return(e,a)=>{const p=m("van-image"),E=m("van-tab"),M=m("van-sticky"),y=m("van-skeleton"),L=m("van-list"),j=m("van-tabs"),S=m("van-popup");return i(),r("div",null,[o("div",pt,[o("div",_t,[o("img",{src:tt,onClick:a[0]||(a[0]=s=>u(w).go(-1))})])]),o("video",{class:"vid","webkit-playsinline":"",playsinline:"","x5-playsinline":"",src:t.url,controls:""},null,8,vt),o("div",mt,[d(j,{active:t.activeName,"onUpdate:active":a[6]||(a[6]=s=>t.activeName=s),sticky:""},{default:_(()=>[d(E,{title:"\u7B80\u4ECB",name:"1"},{default:_(()=>[o("div",ft,[o("div",ht,[d(p,{radius:"50%",class:"img",src:t.avatarUrl},null,8,["src"])]),o("div",gt,[o("span",yt,n(t.nickname),1),t.type==5?(i(),r("span",Ct,n(u(h)(t.fans))+"\u7C89\u4E1D",1)):l("",!0)]),a[11]||(a[11]=o("div",{class:"look"},"+ \u5173\u6CE8",-1))]),o("div",kt,[o("div",Ft,n(t.title),1),o("div",Tt,[o("span",bt,"\u64AD\u653E\u91CF\uFF1A"+n(u(h)(t.playTime))+"\xA0\xA0",1),t.type==5?(i(),r("span",wt,n(u(T)(t.publishTime)),1)):(i(),r("span",xt,n(t.publishTime),1))]),o("div",Dt,n(t.description),1),o("div",Bt,[t.praisedCount!=0?(i(),r("div",At,[a[12]||(a[12]=o("img",{src:b,alt:""},null,-1)),o("span",null,n(t.praisedCount),1)])):l("",!0),o("div",Rt,[a[13]||(a[13]=o("img",{src:ot,alt:""},null,-1)),o("span",null,n(t.subscribeCount),1)]),o("div",Et,[a[14]||(a[14]=o("img",{src:et,alt:""},null,-1)),o("span",null,n(t.shareCount),1)])]),o("div",Lt,[(i(!0),r(k,null,F(t.videoGroup,(s,C)=>(i(),r("div",{class:"item_tag",key:C},n(s.name),1))),128))]),o("div",Nt,[(i(!0),r(k,null,F(t.videoRelated,(s,C)=>(i(),r("div",{class:"item",key:C,onClick:Ko=>v.value=s.vid},[o("div",Vt,[d(p,{class:"img",radius:"8",src:s.coverUrl},null,8,["src"]),a[15]||(a[15]=o("img",{src:st,alt:""},null,-1))]),o("div",It,[o("div",$t,n(s.title),1),o("span",null,n(u(at)(s.durationms))+"\uFF0Cby\xA0"+n(s.creator[0].userName)+"\uFF0C"+n(u(h)(s.playTime))+"\u64AD\u653E",1)])],8,Ut))),128))])])]),_:1}),d(E,{title:"\u8BC4\u8BBA"+t.commentCount,name:"2"},{default:_(()=>[d(L,{loading:t.requestLoading,"onUpdate:loading":a[4]||(a[4]=s=>t.requestLoading=s),error:t.error,"onUpdate:error":a[5]||(a[5]=s=>t.error=s),finished:t.finish,"immediate-check":!1,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:R},{loading:_(()=>a[16]||(a[16]=[o("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[o("img",{width:"18",src:$,alt:""}),o("span",null,"\u52A0\u8F7D\u4E2D...")],-1)])),default:_(()=>[d(M,{"offset-top":44},{default:_(()=>[o("div",Pt,[a[17]||(a[17]=o("div",{class:"title"},"\u8BC4\u8BBA\u533A",-1)),X(o("div",qt,[o("span",{class:D({choosed:t.sortType==99}),onClick:a[1]||(a[1]=s=>x(99))},"\u63A8\u8350",2),o("span",{class:D({choosed:t.sortType==2}),onClick:a[2]||(a[2]=s=>x(2))},"\u6700\u70ED",2),o("span",{class:D({choosed:t.sortType==3}),onClick:a[3]||(a[3]=s=>x(3))},"\u6700\u65B0",2)],512),[[Y,!t.arrloading]])])]),_:1}),d(y,{title:"",avatar:"",row:3,loading:t.arrloading},{default:_(()=>[o("div",Gt,[(i(!0),r(k,null,F(t.arr,s=>(i(),r("div",{class:"comment_item",key:s.commentId},[o("div",Mt,[d(p,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),o("div",jt,[o("div",St,[o("div",zt,[o("div",Ht,[U(n(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(i(),r("span",Jt,[a[18]||(a[18]=o("img",{src:I,alt:""},null,-1)),s.user.vipRights.redVipLevel==6?(i(),r("span",Kt,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(i(),r("span",Ot,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(i(),r("span",Qt,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(i(),r("span",Wt,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(i(),r("span",Xt,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(i(),r("span",Yt,"\xB7\u4E00")):l("",!0)])):l("",!0)]),o("div",Zt,[o("span",to,n(u(T)(s.time)),1),s.tag.datas?(i(),r("span",oo,"-")):l("",!0),s.tag.datas!=null&&s.tag.datas.length?(i(),r("span",eo,n(s.tag.datas[0].text),1)):l("",!0)])]),o("div",so,[o("span",ao,n(u(h)(s.likedCount)),1),s.liked?(i(),r("img",io)):(i(),r("img",ro))])]),d(B,{content:s.content},null,8,["content"]),s.showFloorComment.showReplyCount?(i(),r("div",{key:0,class:"reply_count",onClick:C=>q(s,s.commentId)},n(s.showFloorComment.replyCount)+"\u6761\u56DE\u590D\xA0>",9,no)):l("",!0)])]))),128))])]),_:1},8,["loading"]),d(y,{title:"",avatar:"",row:3,loading:t.arrloading},null,8,["loading"]),d(y,{title:"",avatar:"",row:3,loading:t.arrloading},null,8,["loading"]),d(y,{title:"",avatar:"",row:3,loading:t.arrloading},null,8,["loading"])]),_:1},8,["loading","error","finished"])]),_:1},8,["title"])]),_:1},8,["active"])]),d(S,{show:u(g).showFloor,"onUpdate:show":a[9]||(a[9]=s=>u(g).showFloor=s),closeable:"",round:"",onClose:a[10]||(a[10]=s=>u(g).close()),"close-on-popstate":!0,"close-icon-position":"top-left",position:"bottom",style:{height:"80%"}},{default:_(()=>[d(L,{loading:t.floorLoading,"onUpdate:loading":a[7]||(a[7]=s=>t.floorLoading=s),error:t.floorError,"onUpdate:error":a[8]||(a[8]=s=>t.floorError=s),"immediate-check":!0,finished:t.floorFinish,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:G},{loading:_(()=>a[19]||(a[19]=[o("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[o("img",{width:"18",src:$,alt:""}),o("span",null,"\u52A0\u8F7D\u4E2D...")],-1)])),default:_(()=>[o("div",lo,[o("div",uo,"\u56DE\u590D("+n(t.floorArr.length)+")",1),o("div",co,[o("div",po,[d(p,{round:"",width:"30",height:"30",src:t.floorTopComment.user.avatarUrl},null,8,["src"])]),o("div",_o,[o("div",vo,[o("div",mo,[o("div",fo,n(t.floorTopComment.user.nickname),1),o("div",ho,[o("span",go,n(u(T)(t.floorTopComment.time)),1)])]),o("div",yo,[o("span",Co,n(u(h)(t.floorTopComment.likedCount)),1),t.floorTopComment.liked?(i(),r("img",ko)):(i(),r("img",Fo))])]),d(B,{content:t.floorTopComment.content},null,8,["content"])])]),a[21]||(a[21]=o("div",{class:"all_reply"},"\u5168\u90E8\u56DE\u590D",-1)),(i(!0),r(k,null,F(t.floorArr,s=>(i(),r("div",{class:"comment_item",key:s.commentId},[o("div",To,[d(p,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),o("div",bo,[o("div",wo,[o("div",xo,[o("div",Do,[U(n(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(i(),r("span",Bo,[a[20]||(a[20]=o("img",{src:I,alt:""},null,-1)),s.user.vipRights.redVipLevel==6?(i(),r("span",Ao,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(i(),r("span",Ro,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(i(),r("span",Eo,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(i(),r("span",Lo,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(i(),r("span",No,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(i(),r("span",Uo,"\xB7\u58F9")):l("",!0)])):l("",!0)]),o("div",Vo,[o("span",Io,n(u(T)(s.time)),1)])]),o("div",$o,[o("span",Po,n(u(h)(s.likedCount)),1),s.liked?(i(),r("img",qo)):(i(),r("img",Go))])]),d(B,{content:s.content},null,8,["content"]),s.beReplied.length&&s.beReplied[0].beRepliedCommentId!=t.floorTopComment.commentId?(i(),r("div",Mo,[o("span",jo,"@"+n(s.beReplied[0].user.nickname)+"\uFF1A",1),s.beReplied[0].content?(i(),r("span",So,n(s.beReplied[0].content),1)):(i(),r("span",zo,"\u8BE5\u8BC4\u8BBA\u5DF2\u5220\u9664"))])):l("",!0)])]))),128))])]),_:1},8,["loading","error","finished"])]),_:1},8,["show"])])}}});var ee=z(Jo,[["__scopeId","data-v-26a0a908"]]);export{ee as default};
