import{_ as R,d as z,r as u,s as M,a as k,w as _,o as q,g as B,T as m,b as U,c as a,e as r,f as F,h as b,u as t,i as g,n as w,j as o,k as N,t as d,l as D,m as C,p as V,q as H,v as K,x as A,y as j,K as O,F as G,z as J}from"./index.105eb99a.js";import{_ as $}from"./loading.1e3c318a.js";import{_ as Q}from"./sub.f0b346da.js";import{_ as W}from"./comment.17c56d6e.js";import{_ as X}from"./share.56451215.js";import{d as Y}from"./download.47019da3.js";var Z="/Flutter_web_deploy/assets/stop_icon.f272f983.svg",ss="/Flutter_web_deploy/assets/play_icon.971b473f.svg",es="/Flutter_web_deploy/assets/list_icon.82c00d89.svg",os="/Flutter_web_deploy/assets/circulate_gray.91b2c30b.svg",ts="/Flutter_web_deploy/assets/circulate_random_gray.6d9ef32b.svg",ns="/Flutter_web_deploy/assets/circulate_one_gray.cd22f14b.svg",ls="/Flutter_web_deploy/assets/collect_gray.f1b40daf.svg",is="/Flutter_web_deploy/assets/finger.bd88e2ba.svg",as="/Flutter_web_deploy/assets/delete_gray.de068543.svg",us="/Flutter_web_deploy/assets/delete.f02346d1.svg",rs="/Flutter_web_deploy/assets/cover-bg-in.c5a56a3e.png",ds="/Flutter_web_deploy/assets/download_gray.ec9df863.svg",_s="/Flutter_web_deploy/assets/singer.b8c9cb78.svg",gs="/Flutter_web_deploy/assets/album.86b904fe.svg",ps="/Flutter_web_deploy/assets/cloud.ca8a16e8.svg",vs="/Flutter_web_deploy/assets/lingsheng.6ca203ba.svg",ms="/Flutter_web_deploy/assets/buy.4891d408.svg",fs="/Flutter_web_deploy/assets/hide.ed379cee.svg";const cs={class:"home"},ys={key:0,class:"songDiv"},Fs=["src"],bs={class:"info"},ws={class:"song_name"},Cs={class:"song_author"},Es={key:0,src:Z,alt:""},ks={key:1,src:ss,alt:""},Bs={class:"pop_list"},Ds={class:"title"},As={class:"option"},$s={key:0,class:"circulate"},xs={key:1,class:"circulate"},Ls={key:2,class:"circulate"},Ts={class:"get"},hs={class:"list"},Ss=["onClick"],Is={class:"icon"},Ps={key:0,src:$,alt:""},Rs={class:"author"},zs=["onClick"],Ms={key:0,class:"load"},qs={class:"song_detail"},Us={class:"info"},Ns={class:"img"},Vs=["src"],Hs={class:"title"},Ks={class:"author"},js={class:"item"},Os={class:"item"},Gs={name:"home"},Js=z({...Gs,setup(Qs){const p=H();K(),u(0);const s=M(),n=u(new Audio);u(),u(),u(),u(),u();let y=u();u("00:00.00"),k([]),u();const E=u(""),f=k(["song","discover"]);function x(){s.play(!s.song_info.isPlaying)}const L=()=>{p.push({path:"/song"})};function T(){y.value=setInterval(()=>{s.set_song_time(n.value.currentTime),s.set_song_allTime(n.value.duration)},1e3)}_(()=>s.song_info.isPlaying,(i,e)=>{i?(n.value.src||(n.value.src=s.song_info.url),n.value.autoplay=!0,n.value.play(),T()):(n.value.pause(),clearInterval(y.value))}),_(()=>s.song_info.id,async(i,e)=>{if(i){n.value.pause(),m.loading({message:"\u83B7\u53D6\u97F3\u4E50\u4E2D\uFF0C\u8BF7\u7A0D\u540E",overlay:!0,duration:0,forbidClick:!0});const v=await B(s.song_info.id,s.song_info.type);m.clear(),s.set_song_url(v.data[0].url),n.value.src=s.song_info.url,n.value.play(),s.play(!0),s.song_info.id&&s.lyricRequest()}}),_(()=>s.song_info.progressTime,()=>{n.value.currentTime=s.song_info.progressTime}),_(()=>p.currentRoute.value,(i,e)=>{if(s.set_load(!1),i.meta.level>e.meta.level){if(e.name=="song")return;f.push(i.name),E.value="slide-left"}else f.splice(f.indexOf(e.name),1),E.value="slide-right"}),_(()=>s.song_info.currentTime,i=>{s.song_info.lyricAll.forEach((e,v,c)=>{i>=e.time&&i<=c[v+1].time&&s.set_lyric(e.lyric)})}),_(()=>s.song_info.volume,i=>{n.value.volume=s.song_info.volume}),_(()=>s.song_info.lyric,i=>{console.info(`%c > ${i.replace("<br>"," > ")}`,"color:#db2c1f;background:rgba(0,0,0,0.2);font-size:25px;border-radius:6px")}),q(async()=>{if(s.song_info.id){const i=await B(s.song_info.id);s.set_song_url(i.data[0].url),s.song_info.list.length==0&&s.add_song({id:s.song_info.id,name:s.song_info.name,author:s.song_info.author,img:s.song_info.img,url:s.song_info.url})}localStorage.getItem("songId")&&m("\u53D1\u73B0\u4E0A\u6B21\u64AD\u653E\u6570\u636E\uFF0C\u52A0\u5165\u64AD\u653E\u5217\u8868"),n.value.preload="auto",n.value.load(),n.value.addEventListener("progress",()=>{if(s.set_song_allTime(n.value.duration),n.value.buffered.length>0){let i=n.value.buffered.end(n.value.buffered.length-1);s.set_song_buffered(i)}}),n.value.addEventListener("loadstart",()=>{}),n.value.addEventListener("error",()=>{s.play(!1),m.fail("\u6570\u636E\u7F13\u51B2\u5931\u8D25")}),n.value.addEventListener("stalled",()=>{s.song_info.isPlaying&&m("\u5F53\u524D\u7F51\u7EDC\u8F83\u5DEE"),s.song_info.duration||s.set_song_allTime(0)}),n.value.addEventListener("waiting",()=>{}),n.value.addEventListener("play",()=>{console.info("%c > console \u6B4C\u8BCD\u7CFB\u7EDF\u5DE5\u4F5C ing","color:#db2c1f;background:rgba(0,0,0,0.2);font-size:25px;border-radius:6px")}),n.value.addEventListener("pause",()=>{}),n.value.addEventListener("ended",()=>{s.play(!1),s.play_next(null)}),n.value.addEventListener("ready",()=>{}),s.song_info.id&&s.lyricRequest(),window.addEventListener("popstate",()=>{setTimeout(()=>{let i=sessionStorage.getItem("scrollTop");i&&window.scrollTo(0,parseInt(i))},520)})});const h=u("slide");h.value="slide-left",U(()=>{clearInterval(y.value)});const S=()=>{s.set_pop_list(!0)},I=i=>{s.close(),p.push({path:"/comment",query:{id:i}})};return(i,e)=>{const v=A("router-view"),c=A("van-popup");return a(),r("div",cs,[F(v,null,{default:b(({Component:l})=>[(a(),C(O,{include:f},[(a(),C(j(l)))],1032,["include"]))]),_:1}),t(s).song_info.id&&t(p).currentRoute.value.name!="song"?(a(),r("div",ys)):g("",!0),t(p).currentRoute.value.name!="song"?(a(),r("div",{key:1,class:w(["song",{fixed_out:!t(s).song_info.id}]),onClick:e[1]||(e[1]=l=>L())},[o("div",{class:"song_img rotate",style:N({animationPlayState:t(s).song_info.isPlaying?"running":"paused"})},[o("img",{src:t(s).song_info.img,alt:""},null,8,Fs)],4),o("div",bs,[o("div",ws,d(t(s).song_info.name),1),o("div",Cs,"-"+d(t(s).song_info.author),1)]),o("div",{class:"icon",onClick:e[0]||(e[0]=D(l=>x(),["stop"]))},[t(s).song_info.isPlaying?(a(),r("img",Es)):(a(),r("img",ks))]),o("img",{onClick:D(S,["stop"]),src:es,alt:""})],2)):g("",!0),F(c,{show:t(s).showList,"onUpdate:show":e[6]||(e[6]=l=>t(s).showList=l),"lock-scroll":!1,round:"",onClose:e[7]||(e[7]=l=>t(s).close()),"close-on-popstate":!0,position:"bottom",style:{height:"50%"}},{default:b(()=>[o("div",Bs,[o("div",Ds,"\u5F53\u524D\u64AD\u653E\u5217\u8868("+d(t(s).song_info.list.length)+")",1),o("div",As,[t(s).song_info.playMode==1?(a(),r("div",$s,[o("img",{onClick:e[2]||(e[2]=l=>t(s).set_circulate()),src:os,alt:""}),e[13]||(e[13]=o("span",null,"\u5217\u8868\u5FAA\u73AF",-1))])):g("",!0),t(s).song_info.playMode==2?(a(),r("div",xs,[o("img",{onClick:e[3]||(e[3]=l=>t(s).set_circulate()),src:ts,alt:""}),e[14]||(e[14]=o("span",null,"\u968F\u673A\u64AD\u653E",-1))])):g("",!0),t(s).song_info.playMode==3?(a(),r("div",Ls,[o("img",{onClick:e[4]||(e[4]=l=>t(s).set_circulate()),src:ns,alt:""}),e[15]||(e[15]=o("span",null,"\u5355\u66F2\u5FAA\u73AF",-1))])):g("",!0),o("div",Ts,[e[16]||(e[16]=o("img",{src:ls,alt:""},null,-1)),e[17]||(e[17]=o("img",{class:"finger",src:is,alt:""},null,-1)),e[18]||(e[18]=o("span",null,"\u6536\u85CF\u5168\u90E8",-1)),o("img",{class:"del_list",onClick:e[5]||(e[5]=l=>t(s).delete_all()),src:as,alt:""})])]),o("div",hs,[(a(!0),r(G,null,J(t(s).song_info.list,l=>(a(),r("div",{class:"item",key:l.id},[o("div",{class:w({info:!0,red:l.id==t(s).song_info.id}),onClick:P=>t(s).play_by_id(l.id)},[o("div",Is,[l.id==t(s).song_info.id?(a(),r("img",Ps)):g("",!0)]),o("span",{class:w({name:!0,red:l.id==t(s).song_info.id})},d(l.name),3),e[19]||(e[19]=o("span",null,"\xA0-\xA0",-1)),o("span",Rs,d(l.author),1)],10,Ss),o("img",{class:"delete",onClick:P=>t(s).delete(l.id),src:us,alt:""},null,8,zs)]))),128))])])]),_:1},8,["show"]),(a(),C(V,{to:"#app"},[t(s).showLoading?(a(),r("div",Ms,e[20]||(e[20]=[o("img",{src:$,alt:""},null,-1),o("span",null,"\u52A0\u8F7D\u4E2D...",-1)]))):g("",!0)])),F(c,{show:t(s).showDetail,"onUpdate:show":e[11]||(e[11]=l=>t(s).showDetail=l),round:"",onClose:e[12]||(e[12]=l=>t(s).close()),"close-on-popstate":!0,position:"bottom",style:{height:"50%"}},{default:b(()=>[o("div",qs,[o("div",Us,[o("div",Ns,[o("img",{src:t(s).song_pop_detail.img,alt:""},null,8,Vs)]),o("div",Hs,[o("span",null,"\u6B4C\u66F2\uFF1A"+d(t(s).song_pop_detail.name),1),o("span",Ks,d(t(s).song_pop_detail.author),1)])]),o("div",{class:"item",onClick:e[8]||(e[8]=l=>t(s).add_song(t(s).song_pop_detail))},e[21]||(e[21]=[o("img",{style:{"border-radius":"50%"},src:rs,alt:""},null,-1),o("span",null,"\u4E0B\u4E00\u9996\u64AD\u653E",-1)])),e[26]||(e[26]=o("div",{class:"item"},[o("img",{src:Q,alt:""}),o("span",null,"\u6536\u85CF\u5230\u6B4C\u5355")],-1)),o("div",{class:"item",onClick:e[9]||(e[9]=l=>t(Y)(t(s).song_pop_detail.url,{id:t(s).song_pop_detail.id,name:t(s).song_pop_detail.name,author:t(s).song_pop_detail.author}))},e[22]||(e[22]=[o("img",{src:ds,alt:""},null,-1),o("span",null,"\u4E0B\u8F7D",-1)])),o("div",{class:"item",onClick:e[10]||(e[10]=l=>I(t(s).song_pop_detail.id.toString()))},[e[23]||(e[23]=o("img",{src:W,alt:""},null,-1)),o("span",null,"\u8BC4\u8BBA\uFF08"+d(t(s).song_pop_detail.commentCount)+"\uFF09",1)]),e[27]||(e[27]=o("div",{class:"item"},[o("img",{src:X,alt:""}),o("span",null,"\u5206\u4EAB")],-1)),o("div",js,[e[24]||(e[24]=o("img",{src:_s,alt:""},null,-1)),o("span",null,"\u6B4C\u624B\uFF1A"+d(t(s).song_pop_detail.author),1)]),o("div",Os,[e[25]||(e[25]=o("img",{src:gs,alt:""},null,-1)),o("span",null,"\u4E13\u8F91\uFF1A"+d(t(s).song_pop_detail.al),1)]),e[28]||(e[28]=o("div",{class:"item"},[o("img",{src:ps,alt:""}),o("span",null,"\u4E91\u8D1D\u63A8\u6B4C")],-1)),e[29]||(e[29]=o("div",{class:"item"},[o("img",{src:vs,alt:""}),o("span",null,"\u8BBE\u7F6E\u94C3\u58F0")],-1)),e[30]||(e[30]=o("div",{class:"item"},[o("img",{src:ms,alt:""}),o("span",null,"\u5355\u66F2\u8D2D\u4E70")],-1)),e[31]||(e[31]=o("div",{class:"item"},[o("img",{src:fs,alt:""}),o("span",null,"\u5C4F\u853D\u6B4C\u66F2\u6216\u8005\u6B4C\u624B")],-1))])]),_:1},8,["show"])])}}});var oe=R(Js,[["__scopeId","data-v-21e0941a"]]);export{oe as default};
