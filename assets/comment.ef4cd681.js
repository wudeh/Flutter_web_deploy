var O=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var V=(p,d,_)=>d in p?O(p,d,{enumerable:!0,configurable:!0,writable:!0,value:_}):p[d]=_,P=(p,d)=>{for(var _ in d||(d={}))W.call(d,_)&&V(p,_,d[_]);if(I)for(var _ of I(d))X.call(d,_)&&V(p,_,d[_]);return p},U=(p,d)=>K(p,Q(d));import{i as Y,u as Z,l as oo,H as so,T as eo,n as to,r as k,o as n,q as a,s as u,w as m,y as e,t,A as c,I as F,F as x,C as B,v as l,J as no,O as ao,x as q,E as ro,G as io}from"./vendor.1af84381.js";import{_ as S}from"./loading.ae9c4f02.js";import{_ as lo}from"./left_arrow_black.54b43e41.js";import{c as L,_ as $,a as T,b as w}from"./commentText.871a8882.js";import{_ as co,s as uo,e as _o,b as po,c as fo,d as j,f as M}from"./index.c01db281.js";import{s as D,n as A}from"./num.de8f9d34.js";const g=p=>(ro("data-v-130eb76f"),p=p(),io(),p),go=g(()=>e("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[e("img",{width:"18",src:S,alt:""}),e("span",null,"\u52A0\u8F7D\u4E2D...")],-1)),ho={class:"navSongList"},mo=g(()=>e("img",{src:lo,alt:""},null,-1)),vo=[mo],yo={class:"comment_count"},ko={class:"song_info"},Co={class:"img"},Fo={key:0,class:"info"},xo={class:"title"},Bo={key:0,class:"singer"},Lo=g(()=>e("span",{style:{color:"black"}},"by\xA0",-1)),To={key:1,class:"singer"},wo=g(()=>e("span",{style:{color:"black"}},"by\xA0",-1)),Do=["onClick"],Ao={key:0},Ro={class:"comment_choose"},bo=g(()=>e("div",{class:"title"},"\u8BC4\u8BBA\u533A",-1)),Eo={class:"choose"},No={class:"comment_area"},Io={class:"avatar"},Vo={class:"info"},Po={class:"top"},Uo={class:"top_left"},qo={class:"name"},So={key:0,style:{display:"flex","align-items":"center"}},$o=g(()=>e("img",{src:$,alt:""},null,-1)),jo={key:0,class:"level"},Mo={key:1,class:"level"},zo={key:2,class:"level"},Go={key:3,class:"level"},Ho={key:4,class:"level"},Jo={key:5,class:"level"},Oo={class:"time"},Ko={class:"time"},Qo={key:0,style:{margin:"0 2px"}},Wo={key:1,class:"tag"},Xo={class:"like_count"},Yo={class:"count"},Zo={key:0,src:T,alt:""},os={key:1,src:w,alt:""},ss=["onClick"],es=g(()=>e("div",{style:{display:"flex","align-items":"center","justify-content":"center"}},[e("img",{width:"18",src:S,alt:""}),e("span",null,"\u52A0\u8F7D\u4E2D...")],-1)),ts={class:"floor"},ns={class:"reply_count"},as={class:"comment_item floor_top"},rs={class:"avatar"},is={class:"info"},ls={class:"top"},cs={class:"top_left"},ds={class:"name"},us={class:"time"},_s={class:"time"},ps={class:"like_count"},fs={class:"count"},gs={key:0,src:T,alt:""},hs={key:1,src:w,alt:""},ms=g(()=>e("div",{class:"all_reply"},"\u5168\u90E8\u56DE\u590D",-1)),vs={class:"avatar"},ys={class:"info"},ks={class:"top"},Cs={class:"top_left"},Fs={class:"name"},xs={key:0,style:{display:"flex","align-items":"center"}},Bs=g(()=>e("img",{src:$,alt:""},null,-1)),Ls={key:0,class:"level"},Ts={key:1,class:"level"},ws={key:2,class:"level"},Ds={key:3,class:"level"},As={key:4,class:"level"},Rs={key:5,class:"level"},bs={class:"time"},Es={class:"time"},Ns={class:"like_count"},Is={class:"count"},Vs={key:0,src:T,alt:""},Ps={key:1,src:w,alt:""},Us={key:0,class:"beReplied_item"},qs={class:"beReplied_name"},Ss={key:0,class:"beReplied_content"},$s={key:1,class:"beReplied_content"},js={name:"comment"};function Ms(p){const d=Z(),_=uo(),v=d.currentRoute.value.query.id;let f=d.currentRoute.value.query.type;const o=oo({img:"",name:"",singer:"",singerInfo:[],commentTotal:0,pageNo:1,floorPageNo:0,sortType:2,sortTypeName:"",sortTypeList:[],cursor:"",arr:[],floorArr:[],floorTopComment:{user:{avatarUrl:""}},floorLoading:!1,floorError:!1,floorFinish:!1,showFloor:!1,imgloading:!0,arrloading:!0,requestLoading:!1,error:!1,finish:!1,haveFirstFloorPop:!1});so(async()=>{let r;if(f==2&&(r=await _o(v),o.img=r.playlist.coverImgUrl,o.singer=r.playlist.creator.nickname,o.name=r.playlist.name),(f==0||f==null)&&(f=0,r=await po(v),o.img=r.songs[0].al.picUrl,o.name=r.songs[0].name,o.singerInfo=o.singerInfo.concat(r.songs[0].ar),r.songs[0].ar.forEach((i,h)=>{h==0?o.singer+=`${i.name}`:o.singer+=`/${i.name}`})),f==3){const i=await fo(v);o.name=i.album.name,o.img=i.album.picUrl,o.singerInfo=i.album.artists}f==4&&eo("\u7535\u53F0\u8BC4\u8BBA\u6682\u65F6\u65E0\u6CD5\u83B7\u53D6"),r=await j(v,f,o.pageNo,20,o.sortType,o.cursor),o.commentTotal=r.data.totalCount,o.arr=r.data.comments,r.data.cursor&&(o.cursor=r.data.cursor),r.data.sortTypeList.forEach((i,h)=>{o.sortTypeList.push({text:i.sortTypeName,value:i.sortType})}),o.arrloading=!1,o.pageNo+=1,r.data.hasMore||(o.finish=!0)}),to(()=>{});const z=async(r,i)=>{if(o.floorTopComment=r,o.floorLoading=!0,_.set_floor_comment(!0),o.floorArr=[],o.floorFinish=!1,o.floorPageNo=0,o.haveFirstFloorPop){let h=await M(v,i,f,o.floorPageNo);o.floorArr=h.data.comments,o.floorPageNo+=1,o.floorArr.length&&(o.floorPageNo=o.floorArr[o.floorArr.length-1].time),h.data.hasMore||(o.floorFinish=!0),o.floorLoading=!1}},G=async()=>{o.floorLoading=!0,o.haveFirstFloorPop||(o.haveFirstFloorPop=!0);let r=await M(v,o.floorTopComment.commentId,f,o.floorPageNo);o.floorArr=o.floorArr.concat(r.data.comments),o.floorPageNo+=1,o.floorLoading=!1,o.floorArr.length&&(o.floorPageNo=o.floorArr[o.floorArr.length-1].time),r.data.hasMore||(o.floorFinish=!0)},R=async()=>{o.requestLoading=!0;let r=await j(v,f,o.pageNo,20,o.sortType,o.cursor);if(r.code!=200){o.error=!0,o.requestLoading=!1;return}o.requestLoading=!1,o.commentTotal=r.data.totalCount,o.cursor=r.data.cursor,o.arr=o.arr.concat(r.data.comments),o.arrloading=!1,o.pageNo+=1,r.data.hasMore||(o.finish=!0)},b=async r=>{o.sortType=r,o.finish=!1,o.cursor="",o.pageNo=1,o.arr=[],o.error=!1,R()},H=r=>{d.push({name:"singerDetail",query:{id:r}})};return(r,i)=>{const h=k("van-sticky"),C=k("van-image"),y=k("van-skeleton"),E=k("van-list"),J=k("van-popup");return n(),a("div",null,[u(E,{loading:t(o).requestLoading,"onUpdate:loading":i[3]||(i[3]=s=>t(o).requestLoading=s),error:t(o).error,"onUpdate:error":i[4]||(i[4]=s=>t(o).error=s),finished:t(o).finish,"immediate-check":!1,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:R},{loading:m(()=>[go]),default:m(()=>[u(h,null,{default:m(()=>[e("div",ho,[e("div",{class:"back",onClick:i[0]||(i[0]=s=>t(d).go(-1))},vo),e("div",yo,"\u8BC4\u8BBA("+c(t(o).commentTotal)+")",1)])]),_:1}),e("div",ko,[e("div",Co,[u(C,{radius:"8",class:"song_img",src:t(o).img},null,8,["src"])]),u(y,{title:"",row:3,loading:t(o).name==""},null,8,["loading"]),t(o).name?(n(),a("div",Fo,[e("div",xo,c(t(o).name),1),t(f)==2?(n(),a("div",Bo,[Lo,F(c(t(o).singer),1)])):(n(),a("div",To,[wo,(n(!0),a(x,null,B(t(o).singerInfo,(s,N)=>(n(),a("span",{key:s.id,onClick:Gs=>H(s.id)},[F(c(s.name),1),N<t(o).singerInfo.length-1?(n(),a("span",Ao,"/")):l("",!0)],8,Do))),128))]))])):l("",!0)]),u(h,{"offset-top":50},{default:m(()=>[e("div",Ro,[bo,no(e("div",Eo,[e("span",{class:q({choosed:t(o).sortType==2}),onClick:i[1]||(i[1]=s=>b(2))},"\u6700\u70ED",2),e("span",{class:q({choosed:t(o).sortType==3}),onClick:i[2]||(i[2]=s=>b(3))},"\u6700\u65B0",2)],512),[[ao,!t(o).arrloading]])])]),_:1}),u(y,{title:"",avatar:"",row:3,loading:t(o).arrloading},{default:m(()=>[e("div",No,[(n(!0),a(x,null,B(t(o).arr,s=>(n(),a("div",{class:"comment_item",key:s.commentId},[e("div",Io,[u(C,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),e("div",Vo,[e("div",Po,[e("div",Uo,[e("div",qo,[F(c(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(n(),a("span",So,[$o,s.user.vipRights.redVipLevel==6?(n(),a("span",jo,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(n(),a("span",Mo,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(n(),a("span",zo,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(n(),a("span",Go,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(n(),a("span",Ho,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(n(),a("span",Jo,"\xB7\u4E00")):l("",!0)])):l("",!0)]),e("div",Oo,[e("span",Ko,c(t(D)(s.time)),1),s.tag.datas?(n(),a("span",Qo,"-")):l("",!0),s.tag.datas!=null&&s.tag.datas.length?(n(),a("span",Wo,c(s.tag.datas[0].text),1)):l("",!0)])]),e("div",Xo,[e("span",Yo,c(t(A)(s.likedCount)),1),s.liked?(n(),a("img",Zo)):(n(),a("img",os))])]),u(L,{content:s.content},null,8,["content"]),s.showFloorComment.showReplyCount?(n(),a("div",{key:0,class:"reply_count",onClick:N=>z(s,s.commentId)},c(s.showFloorComment.replyCount)+"\u6761\u56DE\u590D\xA0>",9,ss)):l("",!0)])]))),128))])]),_:1},8,["loading"]),u(y,{title:"",avatar:"",row:3,loading:t(o).arrloading},null,8,["loading"]),u(y,{title:"",avatar:"",row:3,loading:t(o).arrloading},null,8,["loading"]),u(y,{title:"",avatar:"",row:3,loading:t(o).arrloading},null,8,["loading"])]),_:1},8,["loading","error","finished"]),u(J,{show:t(_).showFloor,"onUpdate:show":i[7]||(i[7]=s=>t(_).showFloor=s),closeable:"",round:"",onClose:i[8]||(i[8]=s=>t(_).close()),"close-on-popstate":!0,"close-icon-position":"top-left",position:"bottom",style:{height:"80%"}},{default:m(()=>[u(E,{loading:t(o).floorLoading,"onUpdate:loading":i[5]||(i[5]=s=>t(o).floorLoading=s),error:t(o).floorError,"onUpdate:error":i[6]||(i[6]=s=>t(o).floorError=s),"immediate-check":!0,finished:t(o).floorFinish,"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D","finished-text":"\u5DF2\u7ECF\u5230\u5E95\u5566",onLoad:G},{loading:m(()=>[es]),default:m(()=>[e("div",ts,[e("div",ns,"\u56DE\u590D("+c(t(o).floorArr.length)+")",1),e("div",as,[e("div",rs,[u(C,{round:"",width:"30",height:"30",src:t(o).floorTopComment.user.avatarUrl},null,8,["src"])]),e("div",is,[e("div",ls,[e("div",cs,[e("div",ds,c(t(o).floorTopComment.user.nickname),1),e("div",us,[e("span",_s,c(t(D)(t(o).floorTopComment.time)),1)])]),e("div",ps,[e("span",fs,c(t(A)(t(o).floorTopComment.likedCount)),1),t(o).floorTopComment.liked?(n(),a("img",gs)):(n(),a("img",hs))])]),u(L,{content:t(o).floorTopComment.content},null,8,["content"])])]),ms,(n(!0),a(x,null,B(t(o).floorArr,s=>(n(),a("div",{class:"comment_item",key:s.commentId},[e("div",vs,[u(C,{round:"",width:"30",height:"30",src:s.user.avatarUrl},null,8,["src"])]),e("div",ys,[e("div",ks,[e("div",Cs,[e("div",Fs,[F(c(s.user.nickname)+" \xA0 ",1),s.user.vipRights?(n(),a("span",xs,[Bs,s.user.vipRights.redVipLevel==6?(n(),a("span",Ls,"\xB7\u9646")):l("",!0),s.user.vipRights.redVipLevel==5?(n(),a("span",Ts,"\xB7\u4F0D")):l("",!0),s.user.vipRights.redVipLevel==4?(n(),a("span",ws,"\xB7\u8086")):l("",!0),s.user.vipRights.redVipLevel==3?(n(),a("span",Ds,"\xB7\u4EE8")):l("",!0),s.user.vipRights.redVipLevel==2?(n(),a("span",As,"\xB7\u8D30")):l("",!0),s.user.vipRights.redVipLevel==1?(n(),a("span",Rs,"\xB7\u58F9")):l("",!0)])):l("",!0)]),e("div",bs,[e("span",Es,c(t(D)(s.time)),1)])]),e("div",Ns,[e("span",Is,c(t(A)(s.likedCount)),1),s.liked?(n(),a("img",Vs)):(n(),a("img",Ps))])]),u(L,{content:s.content},null,8,["content"]),s.beReplied.length&&s.beReplied[0].beRepliedCommentId!=t(o).floorTopComment.commentId?(n(),a("div",Us,[e("span",qs,"@"+c(s.beReplied[0].user.nickname)+"\uFF1A",1),s.beReplied[0].content?(n(),a("span",Ss,c(s.beReplied[0].content),1)):(n(),a("span",$s,"\u8BE5\u8BC4\u8BBA\u5DF2\u5220\u9664"))])):l("",!0)])]))),128))])]),_:1},8,["loading","error","finished"])]),_:1},8,["show"])])}}const zs=Y(U(P({},js),{setup:Ms}));var Ys=co(zs,[["__scopeId","data-v-130eb76f"]]);export{Ys as default};
